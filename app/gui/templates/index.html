<!DOCTYPE html>
<html lang="en">
<head>
    <title>HORSE IBI Dashboard</title>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Foundation CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.9.0/dist/css/foundation.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', path='/foundation.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', path='/styles.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', path='/dashboard.css') }}" />
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>
    <div class="app-dashboard shrink-medium">
        {% include 'topbar.html' %}

        <div class="app-dashboard-body off-canvas-wrapper">
            {% include 'sidebar.html' %}

            <div class="app-dashboard-body-content off-canvas-content" data-off-canvas-content>
                <!-- Dashboard Stats Cards -->
                <div class="grid-x grid-padding-x">
                    <div class="large-3 medium-6 cell">
                        <div class="stats-card">
                            <div class="stats-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="stats-number" id="total-intents">0</div>
                            <div class="stats-label">Total Intents</div>
                        </div>
                    </div>
                    
                    <div class="large-3 medium-6 cell">
                        <div class="stats-card warning">
                            <div class="stats-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="stats-number" id="active-threats">0</div>
                            <div class="stats-label">Active Threats</div>
                        </div>
                    </div>
                    
                    <div class="large-3 medium-6 cell">
                        <div class="stats-card success">
                            <div class="stats-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stats-number" id="mitigated-threats">0</div>
                            <div class="stats-label">Mitigated</div>
                        </div>
                    </div>
                    
                    <div class="large-3 medium-6 cell">
                        <div class="stats-card alert">
                            <div class="stats-icon">
                                <i class="fas fa-cog fa-spin"></i>
                            </div>
                            <div class="stats-number" id="processing-intents">0</div>
                            <div class="stats-label">Processing</div>
                        </div>
                    </div>
                </div>                <!-- Main Content Tabs -->
                <div class="dashboard-content">
                    <ul class="tabs" data-tabs id="dashboard-tabs">
                        <li class="tabs-title is-active"><a href="#intents-panel" aria-selected="true">Security Intents</a></li>
                        <li class="tabs-title"><a href="#threats-panel">Detected Threats</a></li>
                        <li class="tabs-title"><a href="#monitoring-panel">System Monitoring</a></li>
                    </ul>

                    <div class="tabs-content" data-tabs-content="dashboard-tabs">
                        <!-- Intents Panel -->
                        <div class="tabs-panel is-active" id="intents-panel">
                            <div class="dashboard-table-header">
                                <h5>Security Intents</h5>
                                <button class="button secondary small" onclick="refreshIntents()">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                            <div id="intents-table-container"></div>
                        </div>

                        <!-- Threats Panel -->
                        <div class="tabs-panel" id="threats-panel">
                            <div class="dashboard-table-header">
                                <h5>Detected Threats</h5>
                                <button class="button secondary small" onclick="refreshThreats()">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                            <div id="threats-table-container"></div>
                        </div>

                        <!-- Monitoring Panel -->
                        <div class="tabs-panel" id="monitoring-panel">
                            <div class="dashboard-table-header">
                                <h5>System Status</h5>
                                <button class="button secondary small" onclick="refreshSystemStatus()">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                            <div id="system-status-container">
                                <div class="callout primary">
                                    <h6>External Services Status</h6>
                                    <div id="services-status">
                                        <div class="service-status">
                                            <span class="service-name">Elasticsearch:</span>
                                            <span class="status-indicator" id="es-status">
                                                <i class="fas fa-circle text-warning"></i> Checking...
                                            </span>
                                        </div>
                                        <div class="service-status">
                                            <span class="service-name">CKB Service:</span>
                                            <span class="status-indicator" id="ckb-status">
                                                <i class="fas fa-circle text-warning"></i> Checking...
                                            </span>
                                        </div>
                                        <div class="service-status">
                                            <span class="service-name">RTR Service:</span>
                                            <span class="status-indicator" id="rtr-status">
                                                <i class="fas fa-circle text-warning"></i> Checking...
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Foundation JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.9.0/dist/js/foundation.min.js" crossorigin="anonymous"></script>
    <script src="{{ url_for('static', path='/scripts.js') }}"></script>
    <script>
        $(document).foundation();
    </script>
</body>
</html>